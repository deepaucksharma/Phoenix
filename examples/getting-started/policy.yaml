version: "1.0"

global:
  # Global settings that apply to the entire policy
  metrics_namespace: "saomf"
  environment: "demo"
  sampling_interval: "10s"
  reporting_interval: "1m"

targets:
  # KPI targets for system operation
  resource_coverage:
    # Target percentage of resources that should be monitored
    metric: "aemf_impact_adaptive_topk_resource_coverage_percent_avg_1m"
    value: 0.9
    min_acceptable: 0.8
    max_acceptable: 0.95
  
  metric_throughput:
    # Target throughput in metrics per second
    metric: "aemf_metrics_processed_per_second"
    value: 5000
    min_acceptable: 1000
    max_acceptable: 10000
  
  resource_usage:
    # Target resource usage (percentage)
    metric: "aemf_system_cpu_usage_percent"
    value: 50.0
    min_acceptable: 10.0
    max_acceptable: 80.0

processors:
  # Processor-specific settings
  priority_tagger:
    enabled: true
    settings:
      update_interval: "30s"
  
  adaptive_topk:
    enabled: true
    settings:
      k_min: 5
      k_max: 30
      initial_k: 10
      update_interval: "10s"
      resource_field: "process.name"
      counter_field: "cpu.usage"

controllers:
  # PID controller settings
  coverage_controller:
    enabled: true
    kpi: "resource_coverage"
    kp: 10.0
    ki: 0.1
    kd: 0.0
    sampling_interval: "10s"
    integral_limit: 10.0
    output:
      processor: "adaptive_topk"
      parameter: "k_value"
      scale_factor: 1.0
      min_value: 5
      max_value: 30

safety:
  # Safety thresholds and emergency settings
  resource_limits:
    cpu_percent: 90
    memory_percent: 90
    max_qps: 20000
  
  emergency_mode:
    enabled: true
    triggers:
      - metric: "aemf_system_cpu_usage_percent"
        threshold: 95
        duration: "1m"
      - metric: "aemf_system_memory_usage_percent"
        threshold: 95
        duration: "1m"
    actions:
      - target: "adaptive_topk"
        parameter: "k_value"
        value: 5