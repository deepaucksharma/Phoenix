global_settings:
  autonomy_level: active  # Use active mode for fast development feedback
  collector_cpu_safety_limit_mcores: 400
  collector_rss_safety_limit_mib: 350

processors_config:
  metric_pipeline:
    resource_filter:
      enabled: true
      filter_strategy: hybrid
      priority_attribute: "aemf.process.priority"
      priority_rules:
        - match: "process.command_line=~/.*java.*/"
          priority: high
        - match: "process.name=~/nginx|httpd/"
          priority: high
        - match: "process.name=~/mysql|postgres|mongodb/"
          priority: critical
        - match: "process.command_line=~/.*python.*/"
          priority: medium
        - match: ".*"
          priority: low
      topk:
        k_value: 25
        k_min: 10
        k_max: 50
        resource_field: "process.executable.name"
        counter_field: "process.cpu.utilization"
        coverage_target: 0.95
      rollup:
        enabled: true
        priority_threshold: "low"
        strategy: "sum"
        name_prefix: "others"

# Adaptive PID controller configuration
adaptive_pid_config:
  controllers:
    - name: coverage_controller
      enabled: true
      kpi_metric_name: aemf_impact_adaptive_topk_resource_coverage_percent_avg_1m
      kpi_target_value: 0.90
      kp: 30
      ki: 5
      kd: 0
      hysteresis_percent: 3
      integral_windup_limit: 100
      output_config_patches:
        - target_processor_name: metric_pipeline
          parameter_path: resource_filter.topk.k_value
          change_scale_factor: -20.0
          min_value: 10
          max_value: 60
    
    # Additional controller for development testing
    - name: rollup_controller
      enabled: true
      kpi_metric_name: aemf_processor_metrics_count
      kpi_target_value: 5000.0
      kp: 0.5
      ki: 0.1
      kd: 0.0
      hysteresis_percent: 5
      integral_windup_limit: 50
      output_config_patches:
        - target_processor_name: metric_pipeline
          parameter_path: resource_filter.rollup.priority_threshold
          change_scale_factor: 1.0
          min_value: 0.0  # Corresponds to "low"
          max_value: 3.0  # Corresponds to "critical"

# Safety mode configurations
safety_config:
  safe_mode_processor_configs:
    metric_pipeline:
      resource_filter:
        topk:
          k_value: 10
        rollup:
          priority_threshold: "critical"

