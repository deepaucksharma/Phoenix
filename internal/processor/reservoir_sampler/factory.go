package reservoir_sampler

import (
    "context"

    "go.opentelemetry.io/collector/component"
    "go.opentelemetry.io/collector/consumer"
    "go.opentelemetry.io/collector/processor"
)

// NewFactory creates a factory for the reservoir_sampler processor.
func NewFactory() processor.Factory {
    return processor.NewFactory(
        component.MustNewType(typeStr),
        createDefaultConfig,
        processor.WithMetrics(createMetricsProcessor, component.StabilityLevelDevelopment),
    )
}

func createDefaultConfig() component.Config {
    return &Config{
        ReservoirSize: 100,
        Enabled:       false,
    }
}

func createMetricsProcessor(
    ctx context.Context,
    set processor.Settings,
    cfg component.Config,
    next consumer.Metrics,
) (processor.Metrics, error) {
    return newProcessor(cfg.(*Config), set, next)
}
